-- < 과제 >
--○ TBL_INSA 테이블의 급여 계산 전용 함수를 정의한다.
--   급여는 (기본급*12)+수당 기반으로 연산을 수행한다.
--   함수명 : FN_PAY(기본급, 수당)
CREATE OR REPLACE FUNCTION FN_PAY
(
    V_BASICPAY  IN TBL_INSA.BASICPAY%TYPE
    , V_SUDANG  IN TBL_INSA.SUDANG%TYPE
)
RETURN NUMBER
IS
    V_PAY NUMBER;
    
BEGIN
    V_PAY := (V_BASICPAY *12) + V_SUDANG;
    
    RETURN V_PAY;
END;
--==>> Function FN_PAY이(가) 컴파일되었습니다.

-- 확인
SELECT NAME, BASICPAY, SUDANG, FN_PAY(BASICPAY,SUDANG)"급여"
FROM TBL_INSA;
--==>> 
/*
홍길동	2610000	200000	31520000
이순신	1320000	200000	16040000
이순애	2550000	160000	30760000
김정훈	1954200	170000	23620400
한석봉	1420000	160000	17200000
이기자	2265000	150000	27330000
장인철	1250000	150000	15150000
김영년	950000	145000	11545000
나윤균	840000	220400	10300400
김종서	2540000	130000	30610000
유관순	1020000	140000	12380000
정한국	880000	114000	10674000
조미숙	1601000	103000	19315000
황진이	1100000	130000	13330000
이현숙	1050000	104000	12704000
이상헌	2350000	150000	28350000
엄용수	950000	210000	11610000
이성길	880000	123000	10683000
박문수	2300000	165000	27765000
유영희	880000	140000	10700000
홍길남	875000	120000	10620000
이영숙	1960000	180000	23700000
김인수	2500000	170000	30170000
김말자	1900000	170000	22970000
우재옥	1100000	160000	13360000
김숙남	1050000	150000	12750000
김영길	2340000	170000	28250000
이남신	892000	110000	10814000
김말숙	920000	124000	11164000
정정해	2304000	124000	27772000
지재환	2450000	160000	29560000
심심해	880000	108000	10668000
김미나	1020000	104000	12344000
이정석	1100000	160000	13360000
정영희	1050000	140000	12740000
이재영	960400	190000	11714800
최석규	2350000	187000	28387000
손인수	2000000	150000	24150000
고순정	2010000	160000	24280000
박세열	2100000	130000	25330000
문길수	2300000	150000	27750000
채정희	1020000	200000	12440000
양미옥	1100000	210000	13410000
지수환	1060000	220000	12940000
홍원신	960000	152000	11672000
허경운	2650000	150000	31950000
산마루	2100000	112000	25312000
이기상	2050000	106000	24706000
이미성	1300000	130000	15730000
이미인	1950000	103000	23503000
권영미	2260000	104000	27224000
권옥경	1020000	105000	12345000
김싱식	960000	108000	11628000
정상호	980000	114000	11874000
정한나	1000000	104000	12104000
전용재	1950000	200000	23600000
이미경	2520000	160000	30400000
김신제	1950000	180000	23580000
*/


--○ TBL_INSA 테이블의 입사일을 기준으로
--   현재까지의 근무년수를 반환하는 함수를 정의한다.
--   단, 근무년수는 소수점 이하 한자리까지 계산한다.
---  함수명 : FN_WORKYEAR(입사일)
CREATE OR REPLACE FUNCTION FN_WORKYEAR
(
 V_IBSADATE IN TBL_INSA.IBSADATE%TYPE
 
)
RETURN NUMBER
IS
    V_GUNU NUMBER;      
    V_YEAR NUMBER;
    
BEGIN
    V_GUNU := (MONTHS_BETWEEN(SYSDATE, V_IBSADATE))/12;
    V_YEAR := TRUNC(V_GUNU,1);
    
    RETURN V_YEAR;
END;
--==>> Function FN_WORKYEAR이(가) 컴파일되었습니다

-- 확인
SELECT NAME, IBSADATE, FN_WORKYEAR(IBSADATE)"근무년도"
FROM TBL_INSA;
--==>>
/*
홍길동	1998-10-11	22.4
이순신	2000-11-29	20.3
이순애	1999-02-25	22.1
김정훈	2000-10-01	20.5
한석봉	2004-08-13	16.6
이기자	2002-02-11	19.1
장인철	1998-03-16	23
김영년	2002-04-30	18.9
나윤균	2003-10-10	17.4
김종서	1997-08-08	23.6
유관순	2000-07-07	20.7
정한국	1999-10-16	21.4
조미숙	1998-06-07	22.8
황진이	2002-02-15	19.1
이현숙	1999-07-26	21.7
이상헌	2001-11-29	19.3
엄용수	2000-08-28	20.6
이성길	2004-08-08	16.6
박문수	1999-12-10	21.3
유영희	2003-10-10	17.4
홍길남	2001-09-07	19.5
이영숙	2003-02-25	18.1
김인수	1995-02-23	26.1
김말자	1999-08-28	21.6
우재옥	2000-10-01	20.5
김숙남	2002-08-28	18.6
김영길	2000-10-18	20.4
이남신	2001-09-07	19.5
김말숙	2000-09-08	20.5
정정해	1999-10-17	21.4
지재환	2001-01-21	20.2
심심해	2000-05-05	20.9
김미나	1998-06-07	22.8
이정석	2005-09-26	15.5
정영희	2002-05-16	18.8
이재영	2003-08-10	17.6
최석규	1998-10-15	22.4
손인수	1999-11-15	21.3
고순정	2003-12-28	17.2
박세열	2000-09-10	20.5
문길수	2001-12-10	19.3
채정희	2003-10-17	17.4
양미옥	2003-09-24	17.5
지수환	2004-01-21	17.2
홍원신	2003-03-16	18
허경운	1999-05-04	21.9
산마루	2001-07-15	19.7
이기상	2001-06-07	19.8
이미성	2000-04-07	21
이미인	2003-06-07	17.8
권영미	2000-06-04	20.8
권옥경	2000-10-10	20.4
김싱식	1999-12-12	21.3
정상호	1999-10-16	21.4
정한나	2004-06-07	16.8
전용재	2004-08-13	16.6
이미경	1998-02-11	23.1
김신제	2003-08-08	17.6
임수봉	2001-10-10	19.4
김신애	2001-10-10	19.4
*/
